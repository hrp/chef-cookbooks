worker_processes 1;
worker_rlimit_nofile 8192;

events {
  worker_connections 2048; 
  use epoll;
}

http {
  passenger_root /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.19;
  passenger_ruby /usr/local/rvm/wrappers/ruby-1.9.3-p194/ruby;
  passenger_pool_idle_time 0;
  passenger_max_pool_size 15;
  passenger_pre_start http://localhost;

  include      mime.types;
  default_type  application/octet-stream;
  sendfile on;
  keepalive_timeout 65; 

  gzip on;
  gzip_http_version 1.0;
  gzip_disable "msie6";
  gzip_vary              on;
  gzip_min_length        512;
  gzip_buffers           64 8k;
  gzip_comp_level        3;
  gzip_proxied           any;
  gzip_types            text/plain 
text/css 
application/x-javascript 
application/javascript
application/json
image/x-icon
text/xml 
application/xml;

  server {
    listen 80;
    server_name localhost;
    root /var/www/cake/current/public;
    passenger_enabled on;
    passenger_min_instances 2;
    rack_env <%= node['passenger-nginx']['rack_env'] %>;
  }
}